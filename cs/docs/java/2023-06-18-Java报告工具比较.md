---
layout: post
title:  使用Selenium处理浏览器选项卡
category: java
copyright: java
excerpt: Java
---

## 1.概述

当我们谈论报告工具时，很多软件都涵盖了这个领域。然而，它们中的大多数都是成熟的商业智能平台或云服务。

但是，如果我们只是想将一些报告功能作为库添加到我们的应用程序中会发生什么？我们将在这里回顾一些非常适合此目的的Java报告工具。

我们将主要关注这些开源工具：

-   [出版](https://www.eclipse.org/birt/)
-   [碧玉报告](https://community.jaspersoft.com/project/jasperreports-library)
-   [Pentaho](https://github.com/pentaho/pentaho-reporting)

此外，我们将简要分析以下商业工具：

-   [精美报告](https://www.finereport.com/en/)
-   [Logi报告](https://www.logianalytics.com/jreport/)(以前称为JReport)
-   [报告工厂](http://www.reportmill.com/product/)

## 2.设计报告

通过本节，我们将回顾如何以可视化方式设计报告和使用我们的数据。请注意，在这一部分中我们将仅提及开源工具。

### 2.1.视觉编辑器

所有这三个工具都包含一个具有报告预览功能的WYSIWIG编辑器。

BIRTReportDesigner和JaspersoftStudio是基于[EclipseRCP](https://wiki.eclipse.org/Rich_Client_Platform)构建的工具。对于我们大多数Java开发人员来说，这是一个很好的观点，因为我们可能熟悉Eclipse环境。与那些不同的是，PentahoReportDesigner的视觉效果很差。

此外，关于JaspersoftStudio还有一个有趣的功能：我们可以直接在他们的JasperReportsServer(报告管理系统)上发布报告。

### 2.2.数据集

与所有报告工具一样，我们可以通过查询数据源来检索数据集(见下文)。然后，我们可以将它们转换为报表字段、创建计算字段或使用聚合公式。

除此之外，比较我们如何管理多个数据集也很有趣，因为如果我们的数据来自不同的查询甚至不同的数据源，我们可能需要多个数据集：

-   BIRT提供了最简单的解决方案，因为我们可以在同一份报告中拥有多个数据集
-   使用JasperReports和Pentaho，我们每次都需要创建一个单独的子报表，这可能非常棘手

### 2.3.图表和视觉元素

所有工具都提供简单的元素，如形状和图像，以及每种图表风格：线条、区域、饼图、雷达、圆环等。它们都支持交叉表。

然而，JasperReports提供了最丰富的可视化元素集合。它在上面的列表中添加了地图、迷你图、金字塔和甘特图。

### 2.4.造型报告

现在，让我们比较一下页面中元素的定位和大小：

-   所有的工具都提供像素定位
-   BIRT和Pentaho还提供了类HTML定位(table、block、inline)
-   它们都不支持类似CSS的flexbox或网格系统来控制元素大小

此外，当我们必须管理多个报表时，我们可能希望共享相同的视觉主题：

-   JasperReports提供具有XML-CSS语法的主题文件
-   BIRT可以将CSS样式表导入设计系统
-   使用Pentaho，我们只能在页眉中添加CSS样式表。所以很难将它们与内部设计系统混合

## 3.渲染报告

现在，我们已经了解了如何设计报告，让我们比较一下如何以编程方式呈现它们。

### 3.1.安装

首先，我们要注意，所有工具都被设计为可以轻松嵌入到Java项目中。

首先，你可以查看我们关于[BIRT](https://baeldung.com/birt-reports-spring-boot#dependencies)和[JasperReports](https://baeldung.com/spring-jasper#maven-dependency)的专门文章。对于Pentaho，有[帮助页面](https://help.pentaho.com/Documentation/9.0/Developer_center/Embed_reporting_functionality)和免费[代码示例](https://github.com/fcorti/pentaho-8-reporting-for-java-developers)。

接下来，对于这些工具中的每一个，我们都将报表引擎连接到我们的应用程序数据。

### 3.2.数据源

我们应该问的第一个问题是：我们如何将报表引擎连接到我们的项目数据源？

-   JasperReports：我们只需将它添加为[fillReport](https://baeldung.com/spring-jasper#populating-reports)[方法](https://baeldung.com/spring-jasper#populating-reports)的参数
-   BIRT的解决方案有点复杂：我们应该修改我们的报告以将数据源属性设置为参数
-   Pentaho在这里有一个很大的缺点：除非我们购买他们的PDI商业软件，否则我们必须使用JNDI数据源，这更难设置

说到数据源，支持哪些类型？

-   这三个工具都支持最常见的类型：JDBC、JNDI、POJOs、CSV、XML和MongoDB
-   RESTAPI是现代项目的必要条件，然而，它们都没有原生支持它
    -   使用BIRT，我们应该编写一个Groovy脚本
    -   JasperReports需要一个额外的[免费插件](https://community.jaspersoft.com/project/web-service-data-source)
    -   使用Pentaho，我们应该编写Groovy脚本或获取PDI商业软件
-   JasperReports和Pentaho原生支持JSON文件，但BIRT将需要外部Java解析器库
-   [我们可以在这个矩阵](http://www.innoventsolutions.com/comparison-matrix.html)中找到完整的比较列表

### 3.3.参数和运行时定制

由于我们已将报告连接到数据源，让我们呈现一些数据！

现在重要的是如何检索我们的最终用户数据。为此，我们可以将参数传递给渲染方法。这些参数应该在我们设计报表的时候就已经定义好了，而不是在运行时。但是，例如，如果我们的数据集基于最终用户上下文的不同查询，我们该怎么办？

使用Pentaho和JasperReports，根本不可能做到这一点，因为报告文件是二进制的，没有JavaSDK可以修改它们。相比之下，BIRT报告是纯XML文件。此外，我们可以使用JavaAPI来修改它们，因此很容易在运行时自定义所有内容。

### 3.4.输出格式和Javascript客户端

值得庆幸的是，所有工具都支持大多数常见格式：HTML、PDF、Excel、CSV、纯文本和RTF。现在，我们可能还会问如何将报告结果直接集成到我们的网页中。不过，我们不会提及PDF可视化工具的粗略包含。

-   最好的解决方案是使用Javascript客户端将报告直接呈现到HTML元素中。对于BIRT，Javascript客户端是ActuateJSAPI，对于JasperReports，我们应该使用JRIO.js
-   除了iFrame集成，Pentaho不提供任何东西。此解决方案有效但可能有严重的[缺点](https://www.ostraining.com/blog/webdesign/against-using-iframes/)

### 3.5.独立渲染工具

除了将我们的报告集成到网页中，我们可能还对拥有一个开箱即用的呈现服务器感兴趣。每个工具都提供自己的解决方案：

-   BIRT查看器是一个轻量级Web应用程序示例，用于按需执行BIRT报告。它是开源的，但不包括报告管理功能
-   对于Pentaho和JasperReport，只有商业软件包

## 4.项目状态和活动

首先，谈谈许可证。BIRT在EPL下，JasperReports在LGPLv3下，Pentaho在LGPLv2.1下。因此，我们可以将所有这些库嵌入到我们自己的产品中，即使它们是商业产品。

那么，我们可以问问自己，这些开源项目是如何维护的，社区是否还活跃：

-   JasperReports有一个维护良好的[存储库，](https://github.com/TIBCOSoftware/jasperreports)其编辑器TIBCO软件具有稳定的媒体[活动](https://www.openhub.net/p/jasperreports)
-   BIRT[存储库](https://github.com/eclipse/birt)仍在维护，但自2015年OpenText收购其编辑器Actuate以来，[其活动](https://www.openhub.net/p/birt/commits/summary)非常低
-   同样，自2015年Hitachi-Vantara收购以来，Pentaho存储库[活动](https://www.openhub.net/p/pentaho-reporting/commits/summary)非常低

我们可以使用Stackoverflow趋势来确认这一点。[BIRT](https://insights.stackoverflow.com/trends?tags=birt)和[Pentaho](https://insights.stackoverflow.com/trends?tags=pentaho)的受欢迎程度最低，但[JasperReports的](https://insights.stackoverflow.com/trends?tags=jasper-reports)受欢迎程度适中。

在过去5年中，这三种Java报告工具的受欢迎程度都有所下降，但目前仍保持稳定。我们可以通过云和Javascript产品的出现来解释这一点。

## 5.商业Java报告工具

除了开源解决方案外，还有一些值得一提的商业选择。

### 5.1.罚款报告

FineReport最初设计为作为独立服务器执行。幸运的是，如果我们想使用它，我们可以将它作为我们项目的一部分。我们必须手动将所有JAR和资源复制到我们的WAR中，如[他们的过程](http://doc.fanruan.com/display/VHD/Embedded+Deployment)中所述。

完成此操作后，我们可以在我们的项目中看到决策平台工具作为URL可用。从这个URL，我们可以直接在提供的Web视图、iFrame或使用他们的Javascript客户端中执行报告。但是，我们无法以编程方式生成报告。

另一个巨大的限制是目标运行时。版本10仅支持Java 8和Tomcat8.x。

### 5.2.Logi报告(以前称为JReport)

与FineReport一样，LogiReport被设计为作为独立服务器执行，但[我们可以将其集成](https://www.jinfonet.com/kbase/16.1up2/serverguide/index.htm#t=HTML%2Finteg%2Finteg_way.htm)为现有WAR项目的一部分。因此，我们将面临与FineReport相同的限制：我们无法以编程方式生成报告。

不同于精细报告。但是，LogiReport支持几乎所有的servlet容器和Java 8到13。

### 5.3.ReportMill报告

最后，值得一提的是ReportMill，因为我们可以将它顺利地嵌入到每个Java应用程序中。此外，与BIRT一样，它非常灵活：我们可以在运行时自定义报告，因为它们是纯XML文件。

但是，我们可以立即看到ReportMill已经老化，并且与其他解决方案相比功能也很差。

## 六，总结

在本文中，我们介绍了一些最著名的Java报告工具并比较了它们的功能。

作为总结，我们可以根据我们的要求选择这些Java报告工具之一：

我们将选择BIRT：

-   对于一个简单的库来替换现有的自制解决方案
-   因其最大的灵活性和高度的定制潜力

我们将选择JasperReports：

-   如果我们需要一个与成熟的报告管理系统兼容的报告库
-   如果我们想赌最好的长期发展和支持
