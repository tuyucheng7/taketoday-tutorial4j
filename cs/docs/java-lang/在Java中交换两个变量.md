## 1. 概述

有时，我们可能想在代码中交换两个变量。

在本教程中，我们将看到几种方法来做到这一点，具体取决于我们要交换的变量类型。然后，我们将检查每种方法的性能。

## 2. 简单的方法：使用临时变量

交换两个变量的最简单方法是使用第三个变量作为临时存储：

```java
Object a, b;
Object temp;
temp = a;
a = b;
b = temp;
```

这种方法特别容易阅读和理解，即使对于初学者也是如此。它的主要缺点是它需要一个临时变量。

我们应该记住，这种方法是唯一可以交换对象变量的方法。

### 2.1. 为什么不交换方法？

如果我们必须在代码中的多个点交换变量，那么创建一个像这样交换变量的方法听起来可能很有吸引力：

```java
public void swap(Object a, Object b)
```

不幸的是，这在Java中不起作用，因为对对象的[引用](https://www.baeldung.com/java-pass-by-value-or-pass-by-reference)在方法调用期间被。

如果我们真的想要一个 swap 方法，我们必须在你的对象周围使用一个包装器类并交换包装器中包含的对象：

```java
private class Wrapper {
    public String string;
}
```

和交换方法：

```java
private static void swap(Wrapper a, Wrapper b) {
    String temp = b.string;
    b.string = a.string;
    a.string = temp;
}
```

使用此方法，封闭的字符串将在方法返回后保持交换状态。

## 3.没有临时变量

如果我们的变量是原始类型，我们可以找到无需临时变量即可交换它们的方法。

让我们看几个例子。

### 3.1. 使用算术运算

我们可以通过多种方式使用数学来交换没有临时变量的变量。对于以下示例，假设我们要交换两个整数 a=5和b=10。

我们可以使用加法和减法来交换：

```java
a = a + b;  // a = 15
b = a - b;  // b = 5
a = a - b;  // a = 10
```

或者，我们可以使用乘法和除法：

```java
a = a  b;  // a = 50
b = a / b;  // b = 5
a = a / b;  // a = 10
```

我们应该记住，如果任何数字为 0，此方法将不起作用，因为第一个操作将导致存储零，从而使算法的其余部分无用。此外，如果b =0，它将因被零除而抛出[ArithmeticException 。](https://www.baeldung.com/java-overflow-underflow)

我们还应该注意基元容量，因为加法/乘法可能导致数字超过基元类型的最大值。这可能会导致交换后出现错误而不会抛出任何异常。

例如，如果a = Integer.MAX_VALUE，则在交换a=2147483647和b=10之前以及交换之后，a=10，b=-1。

如果我们使用char、byte或short类型的数据，则需要显式强制转换，因为至少在 Java中算术运算符结果是int类型的值：

```java
a = (char)(a + b);
b = (char)(a - b);
a = (char)(a - b);
```

### 3.2. 使用逻辑运算

如果我们使用整数数据类型(即char、short、byte、int、long)，我们可以使用异或按位运算符 (XOR)。“^”运算符将对我们变量的所有位进行按位异或运算：

```java
a = a ^ b;  // a = 1111 (15)
b = a ^ b;  // b = 1010 (5) 
a = a ^ b;  // a = 0101 (10)

```

我们应该知道，对于算术运算符，按位异或运算符至少返回int数据类型。因此，如果我们使用字符、字节或短变量，我们必须为每一行转换 XOR 的结果。

### 3.3. 单行变体

我们可以使用交换方法的单行版本来减少代码大小：

```java
b = (a + b) – (a = b);
a += b – (b = a);
a = a  b / (b = a);
a = a ^ b ^ (b = a);
```

这是有效的，因为表达式是根据运算符的优先级进行评估的。如果最初a = 5 且b = 10，则最后一个表达式等效于a = 5 ^ 10 ^ (b = 5)。第一个操作(5 ^ 10)正好是多行算法的第一行，然后我们将 5 赋给b(括号优先)，最后，我们计算15 ^ 5正好是算法的第三行。

## 4.性能分析

我们刚刚看到Java中交换两个变量的方式有好几种，那么到底哪种方式效率更高呢？为了给出每种算法的性能趋势，我们执行了变量交换方法的循环并测量了交换两个变量 100.000 次所需的时间。我们运行了 10 次测试来计算每个算法的平均执行时间。以下是结果：

[![交换变量 - 性能比较](https://www.baeldung.com/wp-content/uploads/2022/05/swapping-variables-performance-tab.png)](https://www.baeldung.com/wp-content/uploads/2022/05/swapping-variables-performance-tab.png)

绝对时间在这里并不重要，因为它取决于运行测试的机器。我们只看到某些算法比其他算法慢。对于乘法/除法来说尤其如此，无论是在单行版本中，它都要慢得多。相反，异或算法在多行和单行版本中都是最有效的。

使用临时变量交换对象也非常有效，这是可以理解的，因为在这种情况下只操作指针。

## 5.总结

在本文中，我们研究了如何根据变量的类型在Java中交换两个变量。

我们描述了如何交换对象，然后我们研究了几种使用几种算法交换基元类型的方法。最后，我们查看了每种方法的性能。