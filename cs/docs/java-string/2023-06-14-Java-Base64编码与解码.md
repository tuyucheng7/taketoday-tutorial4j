---
layout: post
title:  使用Selenium处理浏览器选项卡
category: java-string
copyright: java-string
excerpt: Java String
---

## 1. 概述

在本教程中，我们探索了在Java中提供Base64编码和解码功能的各种实用程序。

我们将主要说明新的Java 8 API。此外，我们还使用Apache Commons的实用程序API。

## 2. 用于Base64的Java 8

Java 8终于通过java.util.Base64实用程序类向标准API添加了Base64功能。

让我们从一个基本的编码器过程开始。

### 2.1 Java 8基础Base64

基本编码器使事情变得简单，并按原样对输入进行编码，没有任何行分隔。

编码器将输入映射到A-Za-z0-9+/字符集中的一组字符。

让我们首先编码一个简单的String：

```java
String originalInput = "test input";
String encodedString = Base64.getEncoder().encodeToString(originalInput.getBytes());
```

请注意我们如何通过简单的getEncoder()实用程序方法检索完整的编码器API。

现在让我们将该字符串解码回原始形式：

```java
byte[] decodedBytes = Base64.getDecoder().decode(encodedString);
String decodedString = new String(decodedBytes);
```

### 2.2 没有填充的Java 8 Base64编码

在Base64编码中，输出编码的String的长度必须是三的倍数。编码器根据需要在输出的末尾添加一个或两个填充字符(=)以满足此要求。

解码时，解码器会丢弃这些额外的填充字符。要深入了解Base64中的填充，请查看[StackOverflow上的详细答案](https://stackoverflow.com/a/18518605/370481)。

有时，我们需要跳过输出的填充。例如，生成的String永远不会被解码回来。因此，我们可以简单地选择不使用填充进行编码：

```java
String encodedString = 
  Base64.getEncoder().withoutPadding().encodeToString(originalInput.getBytes());
```

### 2.3 Java 8网址编码

URL编码与基本编码器非常相似。此外，它使用URL和文件名安全的Base64字母表。此外，它不添加任何行分隔：

```java
String originalUrl = "https://www.google.co.nz/?gfe_rd=cr&ei=dzbFV&gws_rd=ssl#q=java";
String encodedUrl = Base64.getUrlEncoder().encodeToString(originalURL.getBytes());

```

解码以几乎相同的方式发生。getUrlDecoder()实用程序方法返回java.util.Base64.Decoder。所以，我们用它来解码URL：

```java
byte[] decodedBytes = Base64.getUrlDecoder().decode(encodedUrl);
String decodedUrl = new String(decodedBytes);

```

### 2.4 Java 8 MIME编码

让我们从生成一些基本的MIME输入开始编码：

```java
private static StringBuilder getMimeBuffer() {
    StringBuilder buffer = new StringBuilder();
    for (int count = 0; count < 10; ++count) {
        buffer.append(UUID.randomUUID().toString());
    }
    return buffer;
}
```

MIME编码器使用基本字母表生成Base64编码的输出。但是，该格式是MIME友好的。

每行输出不超过76个字符。此外，它以回车符和换行符(rn)结尾：

```java
StringBuilder buffer = getMimeBuffer();
byte[] encodedAsBytes = buffer.toString().getBytes();
String encodedMime = Base64.getMimeEncoder().encodeToString(encodedAsBytes);
```

在解码过程中，我们可以使用返回java.util.Base64.Decoder的getMimeDecoder()方法：

```java
byte[] decodedBytes = Base64.getMimeDecoder().decode(encodedMime);
String decodedMime = new String(decodedBytes);

```

## 3. 使用Apache Commons代码编码/解码

首先，我们需要在pom.xml中定义[commons-codec](https://search.maven.org/classic/#search|gav|1|g%3A"commons-codec"ANDa%3A"commons-codec")依赖：

```xml
<dependency>
    <groupId>commons-codec</groupId>
    <artifactId>commons-codec</artifactId>
    <version>1.15</version>
</dependency>
```

主要的API是org.apache.commons.codec.binary.Base64类。我们可以使用各种构造函数对其进行初始化：

-   Base64(booleanurlSafe)通过控制URL安全模式(打开或关闭)来创建Base64 API。
-   Base64(intlineLength)在URL不安全模式下创建Base64 API并控制行的长度(默认为76)。
-   Base64(intlineLength,byte[]lineSeparator)通过接收额外的行分隔符创建Base64 API，默认情况下为CRLF(“rn”)。

创建Base64 API后，编码和解码都非常简单：

```java
String originalInput = "test input";
Base64 base64 = new Base64();
String encodedString = new String(base64.encode(originalInput.getBytes()));

```

此外，Base64类的decode()方法返回解码后的字符串：

```java
String decodedString = new String(base64.decode(encodedString.getBytes()));

```

另一种选择是使用Base64的静态API而不是创建实例：

```java
String originalInput = "test input";
String encodedString = new String(Base64.encodeBase64(originalInput.getBytes()));
String decodedString = new String(Base64.decodeBase64(encodedString.getBytes()));
```

## 4. 将字符串转换为字节数组

有时，我们需要将String转换为byte[]。最简单的方法是使用StringgetBytes()方法：

```java
String originalInput = "test input";
byte[] result = originalInput.getBytes();

assertEquals(originalInput.length(), result.length);
```

我们也可以提供编码而不依赖于默认编码。因此，它依赖于系统：

```java
String originalInput = "test input";
byte[] result = originalInput.getBytes(StandardCharsets.UTF_16);

assertTrue(originalInput.length() < result.length);
```

如果我们的字符串是Base64编码的，我们可以使用Base64解码器：

```java
String originalInput = "dGVzdCBpbnB1dA==";
byte[] result = Base64.getDecoder().decode(originalInput);

assertEquals("test input", new String(result));
```

我们还可以使用DatatypeConverter的parseBase64Binary()方法：

```java
String originalInput = "dGVzdCBpbnB1dA==";
byte[] result = DatatypeConverter.parseBase64Binary(originalInput);

assertEquals("test input", new String(result));
```

最后，我们可以使用DatatypeConverter.parseHexBinary方法将十六进制字符串转换为byte[]：

```java
String originalInput = "7465737420696E707574";
byte[] result = DatatypeConverter.parseHexBinary(originalInput);

assertEquals("test input", new String(result));
```

## 5. 总结

本文介绍了如何在Java中进行Base64编码和解码的基础知识。我们使用了Java 8和Apache Commons中引入的新API。

最后，还有一些提供类似功能的其他API：带有printHexBinary和parseBase64Binary的java.xml.bind.DataTypeConverter。
与往常一样，本教程的完整源代码可在[GitHub](https://github.com/tu-yucheng/taketoday-tutorial4j/tree/master/java-core-modules/java-string-algorithms-1)上获得。
